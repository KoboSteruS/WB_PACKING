# WB Storage Report Generator

Скрипт для автоматического получения отчетов о платном хранении с Wildberries и сохранения их в Google Sheets.

## Особенности

- Автоматическое выполнение каждый понедельник в 9:00
- Интеграция с API Wildberries
- Сохранение данных в Google Sheets
- Логирование всех операций
- Обработка ошибок и повторные попытки
- Поддержка временных зон

## Требования

- Python 3.9+
- Google Service Account с доступом к Google Sheets API
- API ключ Wildberries
- Установленные зависимости из requirements.txt

## Установка

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd wb-storage-report
```

2. Создайте виртуальное окружение и активируйте его:
```bash
python -m venv venv
source venv/bin/activate  # для Linux/Mac
venv\Scripts\activate     # для Windows
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

4. Настройте учетные данные:
   - Поместите файл `credentials.json` от Google Service Account в корневую директорию проекта
   - В Google таблице "Storage Table" создайте лист "Настройки" со следующими данными:
     - B1: API ключ Wildberries
     - B3: Дата начала в формате YYYY-MM-DD
     - C3: Дата окончания в формате YYYY-MM-DD
     - B4: Последняя обработанная дата (оставьте пустым для первого запуска)

## Использование

Запустите скрипт:
```bash
python main.py
```

Скрипт будет работать в фоновом режиме и автоматически выполнять следующие действия каждый понедельник в 9:00:
1. Получать данные о платном хранении с Wildberries
2. Форматировать данные
3. Сохранять их в Google Sheets
4. Обновлять дату последней обработки

## Структура проекта

- `main.py` - основной файл приложения
- `config.py` - конфигурационные параметры
- `wb_api.py` - модуль для работы с API Wildberries
- `sheets_client.py` - модуль для работы с Google Sheets
- `requirements.txt` - зависимости проекта
- `app.log` - файл логов

## Логирование

Логи сохраняются в файл `app.log` с ротацией раз в неделю и хранением в течение месяца.

## Обработка ошибок

Скрипт включает обработку следующих ситуаций:
- Отсутствие API ключа
- Ошибки API Wildberries
- Ошибки Google Sheets
- Проблемы с форматированием данных
- Сетевые ошибки

## Лицензия

MIT "# WB_PACKING" 
